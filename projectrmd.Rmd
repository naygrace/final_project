---
title: "final_project"
author: "Naomi-Grace Jennings"
date: "10/16/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(rvest)
library(tidyverse)
library(stringr)
library(ggplot2)
library(dplyr)
library(ggthemes)
library(sentimentr)
library(glue)
library(tidytext)
library(rstanarm)
```


```{r}
# em <- read_html("https://www.allthelyrics.com/lyrics/eminem/lose_yourself-lyrics-10632.html")
# 
# 
# em_title <- em %>%   #Song title 
#   html_nodes(".page-title") %>%
#   html_text()
# 
# em_lyrics <- em %>%   #Song lyrics 
#    html_nodes(".content-text-inner") %>%
#   html_text()
# 
# em.all <- read_html("https://www.allthelyrics.com/lyrics/eminem")
# 
# em_raps <- em.all %>%  #List of all song titles 
#   html_nodes(".lyrics-list-item") %>%
#   # html_attr("href")
#   html_text()
# 
# #em_raps #List of all song titles 
# 
# 
# urls <- em.all %>%  
#    
#   html_nodes("a") %>%
#   html_attr("href") 
#   

#urls # #All urls on page--find way to drop ones that aren't the songs 




 #This is what I'm tryign rn

# lyrics <- urls %>%
#    as_tibble() %>%
#    slice(39:503) %>%
#    summarise(urls = read_html() %>%
#              html_nodes(".context-text-inner") %>%
#              html_text())


```


```{r}
artists1 <- c("kurtis_blow", "grandmaster_melle_mel", "run_dmc", "ll_cool_j", "slick_rick", "ice_cube", "nwa", "redman")

artist_urls <- paste0("https://www.allthelyrics.com/lyrics/", artists1)

finaldata1 <- c() #setting up an empty dataset for the end


for (j in 1:length(artist_urls)) {
  
  all <- read_html(artist_urls[j])
  
  raps <- all %>%
    html_nodes(".lyrics-list-item") %>%
    # html_attr("href")
    html_text()
  
  raps # Here are the raps
  
  
  urls <- all %>%
    html_nodes("a") %>%
    html_attr("href")
  
  urls.d <- data.frame(webpage = urls, line = 1:length(urls))
  raps.d <- data.frame(titles = raps, artist = "Eminem")
  
  
  lyric_data1 <- urls.d %>%
    slice(-(1:38)) %>%
    head(-13) %>%
    mutate(Artist = artists1[j]) %>%
    mutate(titles = raps) %>%
    mutate(line = NULL) %>%
    mutate(webpage = paste0("https://www.allthelyrics.com", webpage))
  
  lyrics1 <- c()
  
  for(i in 1:length(lyric_data1$webpage)){ 
    
    words <- read_html(lyric_data1$webpage[i])
    lyrics1[i] <- words %>%
      html_nodes(".content-text-inner") %>%
      html_text()
    
  }
  
  lyric_data_words1 <- lyric_data1 %>%
    mutate(words = lyrics1)
  
  finaldata1 <- rbind(finaldata1, lyric_data_words1)
  
  
}

View(finaldata1)

write.csv(finaldata1, "finaldata.csv")
```

```{r}
artists2 <- c("nas", "notorious_big", "2pac", "dmx", "jayz", "eminem", "50_cent", "ti") 

artist_urls <- paste0("https://www.allthelyrics.com/lyrics/", artists2)

finaldata2 <- c() #setting up an empty dataset for the end


for (j in 1:length(artist_urls)) {
  
  all <- read_html(artist_urls[j])
  
  raps <- all %>%
    html_nodes(".lyrics-list-item") %>%
    # html_attr("href")
    html_text()
  
  raps # Here are the raps
  
  
  urls <- all %>%
    html_nodes("a") %>%
    html_attr("href")
  
  urls.d <- data.frame(webpage = urls, line = 1:length(urls))
  raps.d <- data.frame(titles = raps, artist = "Eminem")
  
  
  lyric_data2 <- urls.d %>%
    slice(-(1:38)) %>%
    head(-13) %>%
    mutate(Artist = artists2[j]) %>%
    mutate(titles = raps) %>%
    mutate(line = NULL) %>%
    mutate(webpage = paste0("https://www.allthelyrics.com", webpage))
  
  lyrics2 <- c()
  
  for(i in 1:length(lyric_data2$webpage)){ 
    
    words <- read_html(lyric_data2$webpage[i])
    lyrics2[i] <- words %>%
      html_nodes(".content-text-inner") %>%
      html_text()
    
  }
  
  lyric_data_words2 <- lyric_data2 %>%
    mutate(words = lyrics2)
  
  finaldata2 <- rbind(finaldata2, lyric_data_words2)
  
  
}

View(finaldata2)

write.csv(finaldata2, "finaldata.csv")
```

```{r}
artists3 <- c("too_short", "lil_wayne", "kanye_west","drake", "nicki_minaj")
#, "youngboy_never_broke_again", "snoop_dog", "j._cole")



artist_urls <- paste0("https://www.allthelyrics.com/lyrics/", artists3)

finaldata3 <- c() #setting up an empty dataset for the end


for (j in 1:length(artist_urls)) {
  
  all <- read_html(artist_urls[j])
  
  raps <- all %>%
    html_nodes(".lyrics-list-item") %>%
    # html_attr("href")
    html_text()
  
  raps # Here are the raps
  
  
  urls <- all %>%
    html_nodes("a") %>%
    html_attr("href")
  
  urls.d <- data.frame(webpage = urls, line = 1:length(urls))
  raps.d <- data.frame(titles = raps, artist = "Eminem")
  
  
  lyric_data3 <- urls.d %>%
    slice(-(1:38)) %>%
    head(-13) %>%
    mutate(Artist = artists3[j]) %>%
    mutate(titles = raps) %>%
    mutate(line = NULL) %>%
    mutate(webpage = paste0("https://www.allthelyrics.com", webpage))
  
  lyrics3 <- c()
  
  for(i in 1:length(lyric_data3$webpage)){ 
    
    words <- read_html(lyric_data3$webpage[i])
    lyrics3[i] <- words %>%
      html_nodes(".content-text-inner") %>%
      html_text()
    
  }
  
  lyric_data_words3 <- lyric_data3 %>%
    mutate(words = lyrics3)
  
  finaldata3 <- rbind(finaldata3, lyric_data_words3)
  
  
}

View(finaldata3)

write.csv(finaldata3, "finaldata.csv")





```



```{r}
#Counting words

complete_data <- rbind(finaldata1, finaldata2, finaldata3, finaldata4, finaldata5, finaldata6, finaldata7, finaldata8)
write.csv(complete_data, "complete_data.csv")

 

  colnames(complete_data) <- c("webpage", "artist", "title", "words")
```

Average number of misogynistic terms per song for each artist 
```{r}
scores <- complete_data %>%
  
  #select(artist, words, title) %>%
  group_by(artist, title) %>%
    
 mutate(bitch = sum(str_count(words, "bitch")),
           hoe = sum(str_count(words, "hoe")), 
           slut = sum(str_count(words, "slut")),
           whore = sum(str_count(words, "whore")), 
           tease = sum(str_count(words, "tease")), 
           trick = sum(str_count(words, "trick")),
           gold_digger = sum(str_count(words, "gold digger"))) %>%
  mutate(sumrow = bitch + hoe + slut + whore + tease + trick + gold_digger)
        

        
        
   scores %>%
     group_by(artist) %>%
     summarise(me = mean(sumrow)) %>%
     
   
   ggplot(aes(x = factor(artist, level = c("grandmaster_caz", "grandmaster_melle_mel", "kurtis_blow", "kool_moe_dee", "spoonie_gee", "jimmy_spicer",  "run_dmc", "ll_cool_j", "roxanne_shante", "slick_rick", "beastie_boys", "lil_boosie",  "krsone", "too_short", "schoolly_d", "ice_cube", "chuck_d", "grand_puba", "kool_g_rap", "big_daddy_kane", "nwa", "method_man",  "scarface", "dres", "redman", "nas", "notorious_big", "2pac", "raekwon", "prodigy", "busta_rhymes", "twista", "dmx", "jayz", "2_live_crew", "big_pun", "lauryn_hill", "eminem", "ghostface_killah", "ludacris", "jadakiss", "korn", "dr_dre", "50_cent", "common", "killer_mike", "ti",  "lil_wayne", "gucci_mane", "rick_ross",  "kanye_west","drake", "nicki_minaj")), y = me)) +
  geom_col(aes(stat = "identity", position = "stack"), color = "skyblue", fill = "darkblue") +
   labs(title = "Average Usage of Misogynistic Words by Popular Rappers Over the Last 40 Years", subtitle = "Words used by the most popular rap artist of the year", x = "Artist", y = "Average Number of Terms per Song") +
   theme(axis.text.x = element_text(angle = 90)) +
     scale_x_discrete(labels = c("Grandmaster Caz", "Grandmaster Melle Mel", "Kurtis Blow", "Kool Moe Dee", "Spoonie Gee", "Jimmy Spicer",  "Run-DMC", "LL Cool J", "Roxanne Shante", "Slick Rick", "Beastie Boys", "Lil Boosie",  "KRS-One", "Too $hort", "Schoolly D", "Ice Cube", "Chuck D", "Grand Puba", "Kool G Rap", "Big Daddy Kane", "NWA", "Method Man",  "Scarface", "Dres", "Redman", "Nas", "Notorious B.I.G.", "2Pac", "Raekwon", "Prodigy", "Busta Rhymes", "Twista", "DMX", "Jay-Z", "2 Live Crew", "Big Pun", "Lauryn Hill", "Eminem", "Ghostface Killah", "Ludacris", "Jadakiss", "Korn", "D. Dre", "50 Cent", "Common", "Killer Mike", "T.I.",  "Lil Wayne", "Gucci Mane", "Rick Ross",  "Kanye West","Drake", "Nicki Minaj")) +
     theme_clean() +
     theme(axis.text.x = element_text(angle = 90)) 
   

```

Total word count per artist model 
```{r}
total_count <- complete_data %>%
  
  #select(artist, words, title) %>%
  group_by(artist, title) %>%
    
 mutate(bitch = sum(str_count(words, "bitch")),
           hoe = sum(str_count(words, "hoe")), 
           slut = sum(str_count(words, "slut")),
           whore = sum(str_count(words, "whore")), 
           tease = sum(str_count(words, "tease")), 
           trick = sum(str_count(words, "trick")),
           gold_digger = sum(str_count(words, "gold digger"))) %>%
  mutate(sumrow = bitch + hoe + slut + whore + tease + trick + gold_digger) %>%

ggplot(aes(x = factor(artist, level = c("grandmaster_caz", "grandmaster_melle_mel", "kurtis_blow", "kool_moe_dee", "spoonie_gee", "jimmy_spicer",  "run_dmc", "ll_cool_j", "roxanne_shante", "slick_rick", "beastie_boys", "lil_boosie",  "krsone", "too_short", "schoolly_d", "ice_cube", "chuck_d", "grand_puba", "kool_g_rap", "big_daddy_kane", "nwa", "method_man",  "scarface", "dres", "redman", "nas", "notorious_big", "2pac", "raekwon", "prodigy", "busta_rhymes", "twista", "dmx", "jayz", "2_live_crew", "big_pun", "lauryn_hill", "eminem", "ghostface_killah", "ludacris", "jadakiss", "korn", "dr_dre", "50_cent", "common", "killer_mike", "ti",  "lil_wayne", "gucci_mane", "rick_ross",  "kanye_west","drake", "nicki_minaj")), y = sumrow)) +
  geom_col( color = "darkblue", fill = "darkblue", color = "skyblue") +
   labs(title = "Misogynistic Words used by Popular Rappers", subtitle = "From 1979-2016",  x = "Artist", y = "Total Word Count") +
   
     scale_x_discrete(labels = c("Grandmaster Caz", "Grandmaster Melle Mel", "Kurtis Blow", "Kool Moe Dee", "Spoonie Gee", "Jimmy Spicer",  "Run-DMC", "LL Cool J", "Roxanne Shante", "Slick Rick", "Beastie Boys", "Lil Boosie",  "KRS-One", "Too $hort", "Schoolly D", "Ice Cube", "Chuck D", "Grand Puba", "Kool G Rap", "Big Daddy Kane", "NWA", "Method Man",  "Scarface", "Dres", "Redman", "Nas", "Notorious B.I.G.", "2Pac", "Raekwon", "Prodigy", "Busta Rhymes", "Twista", "DMX", "Jay-Z", "2 Live Crew", "Big Pun", "Lauryn Hill", "Eminem", "Ghostface Killah", "Ludacris", "Jadakiss", "Korn", "D. Dre", "50 Cent", "Common", "Killer Mike", "T.I.",  "Lil Wayne", "Gucci Mane", "Rick Ross",  "Kanye West","Drake", "Nicki Minaj")) +
  theme_clean() +
theme(axis.text.x = element_text(angle = 90)) 
        
total_count
        
```








"grandmaster_caz", "grandmaster_melle_mel", "kurtis_blow", "kool_moe_dee", "spoonie_gee", "jimmy_spicer",  "run_dmc", "ll_cool_j", "roxanne_shante", "slick_rick", "beastie_boys", "lil_boosie",  "krsone", "too_short", "schoolly_d", "ice_cube", "chuck_d", "grand_puba", "kool_g_rap", "big_daddy_kane", "nwa", "method_man",  "scarface", "dres", "redman", "nas", "notorious_big", "2pac", "raekwon", "prodigy", "busta_rhymes", "twista", "dmx", "jayz", "2_live_crew", "big_pun", "lauryn_hill", "eminem", "ghostface_killah", "ludacris", "jadakiss", "korn", "dr_dre", "50_cent", "common", "killer_mike", "ti",  "lil_wayne", "gucci_mane", "rick_ross",  "kanye_west","drake", "nicki_minaj"    
      

Song Sentiment distribution for an individual artist (Too $hort)
```{r}
#Sentiments for too short
# too_short <- complete_data %>%
#   filter(Artist == "too_short") %>%
#   select(words, Artist, titles)
# 
#  too_short_sentiments <- sentiment_by(too_short$words,
#  averaging.function = sentimentr::average_downweighted_zero) %>%
#     mutate(total = sum(ave_sentiment)) 
 
 too_short_sentiments <- complete_data %>%
   filter(artist == "too_short") %>%
  select(words, artist, title) %>%
   group_by(title) %>%
   get_sentences() %>%
   
 
sentiment_by(too_short_sentiments$words, by = "title",  
 averaging.function = sentimentr::average_mean) %>%
   group_by(title)

#modeling one artists sentiments each song 
too_short_sentiments %>%
  select(title, ave_sentiment) %>%
  group_by(title) %>%
  summarise(mean = mean(ave_sentiment)) %>%


  
 
 ggplot(aes(x = reorder(title, desc(mean)), y = mean)) +
   geom_col(color = "skyblue", fill = "darkblue") +
  
  labs(title = "Too $hort Sentiment Ratings", subtitle = "Sentiment Ratings of Too $hort songs", y = "Average Sentiment Rating for each Too $hort Song", x = "Songs") +
  theme_clean() +
theme(axis.text.x = element_blank()) 

too_short_sentiments
  
  
```




whole dataset sentiments 
```{r}
sentiments <- complete_data %>%
   
  select(words, artist, title) %>%
   group_by(artist, title) %>%
   get_sentences() %>%
   
 
sentiment_by(sentiments$words, by = c("artist", "title"),  
 averaging.function = sentimentr::average_mean)
  



sentiments %>%
  
  group_by(artist) %>%
  summarise(mean = mean(ave_sentiment)) %>% 
  



  
 
 ggplot(aes(x = factor(artist, level = c("grandmaster_caz", "grandmaster_melle_mel", "kurtis_blow", "kool_moe_dee", "spoonie_gee", "jimmy_spicer",  "run_dmc", "ll_cool_j", "roxanne_shante", "slick_rick", "beastie_boys",  "krsone", "too_short", "schoolly_d", "ice_cube", "chuck_d", "grand_puba", "kool_g_rap", "big_daddy_kane", "nwa", "method_man",  "scarface", "dres", "redman", "nas", "notorious_big", "2pac", "raekwon", "prodigy", "busta_rhymes", "twista", "dmx", "jayz", "big_pun", "lauryn_hill", "eminem", "ghostface_killah", "ludacris", "jadakiss", "dr_dre", "50_cent", "common", "ti",  "lil_wayne", "gucci_mane", "rick_ross",  "kanye_west","drake", "nicki_minaj")), y = mean)) +
   geom_col(fill = "darkblue", color = "skyblue") +
  
  scale_x_discrete(labels = c("Grandmaster Caz", "Grandmaster Melle Mel", "Kurtis Blow", "Kool Moe Dee", "Spoonie Gee", "Jimmy Spicer",  "Run-DMC", "LL Cool J", "Roxanne Shante", "Slick Rick", "Beastie Boys", "Lil Boosie",  "KRS-One", "Too $hort", "Schoolly D", "Ice Cube", "Chuck D", "Grand Puba", "Kool G Rap", "Big Daddy Kane", "NWA", "Method Man",  "Scarface", "Dres", "Redman", "Nas", "Notorious B.I.G.", "2Pac", "Raekwon", "Prodigy", "Busta Rhymes", "Twista", "DMX", "Jay-Z", "2 Live Crew", "Big Pun", "Lauryn Hill", "Eminem", "Ghostface Killah", "Ludacris", "Jadakiss", "Korn", "D. Dre", "50 Cent", "Common", "Killer Mike", "T.I.",  "Lil Wayne", "Gucci Mane", "Rick Ross",  "Kanye West","Drake", "Nicki Minaj")) +
  labs(title = "Average Sentiment Ratings for Popular Rappers", subtitle = "From 1979-2016", x = "Artist", y = "Average Sentiment Rating") +
  theme_clean() +
  theme(axis.text.x = element_text(angle = 90)) 
  
   
#average sentiment for all songs per artist over the years  
sentiments
  
```
Tryna look at sentiment and words together so making sentiment data not numerical but like negative or postitive only then if its negative/positive/neutral give it a plus/minus point and see where that gets you 

   
average sentiment for all songs per artist over the years  
sentiments
  

Tryna look at sentiment and words together so making sentiment data not numerical but like negative or postitive only then if its negative/positive/neutral give it a plus/minus point and see where that gets you 

```{r}
sentiments2 <- complete_data %>%
   select(title, artist, words) %>%
   group_by(artist) %>%
   get_sentences() %>%
   
 
sentiment_by(sentiments2$words, by = c("title", "artist"),  
 averaging.function = sentimentr::average_mean) %>%
   group_by(artist)

new <- merge(sentiments2, scores) %>%


  mutate(rah = case_when((ave_sentiment >= 0 & sumrow <= 0) ~ "positive", 
                        # (ave_sentiment == 0) ~ "neutral", 
                         (ave_sentiment <= 0 & sumrow >= 0) ~ "negative", 
                        TRUE ~ "neutral")) %>%
  
  mutate(har = case_when(rah == "positive" ~ -1, 
                   rah == "neutral" ~ 0, 
                   rah == "negative" ~ 1)) %>%
  
  group_by(artist) %>%
  summarise(sah = sum(har)) 


new %>%
ggplot(aes(x = factor(artist, level = c("grandmaster_caz", "grandmaster_melle_mel", "kurtis_blow", "kool_moe_dee", "spoonie_gee", "jimmy_spicer",  "run_dmc", "ll_cool_j", "roxanne_shante", "slick_rick", "beastie_boys",  "krsone", "too_short", "schoolly_d", "ice_cube", "chuck_d", "grand_puba", "kool_g_rap", "big_daddy_kane", "nwa", "method_man",  "scarface", "dres", "redman", "nas", "notorious_big", "2pac", "raekwon", "prodigy", "busta_rhymes", "twista", "dmx", "jayz", "big_pun", "lauryn_hill", "eminem", "ghostface_killah", "ludacris", "jadakiss", "dr_dre", "50_cent", "common", "ti",  "lil_wayne", "gucci_mane", "rick_ross",  "kanye_west","drake", "nicki_minaj")), y = sah)) +
 # geom_line(aes(group = 1)) +
  geom_point() +
  geom_line(aes(group = 1), color = "darkblue") +
  
  scale_x_discrete(labels = c("Grandmaster Caz", "Grandmaster Melle Mel", "Kurtis Blow", "Kool Moe Dee", "Spoonie Gee", "Jimmy Spicer",  "Run-DMC", "LL Cool J", "Roxanne Shante", "Slick Rick", "Beastie Boys", "Lil Boosie",  "KRS-One", "Too $hort", "Schoolly D", "Ice Cube", "Chuck D", "Grand Puba", "Kool G Rap", "Big Daddy Kane", "NWA", "Method Man",  "Scarface", "Dres", "Redman", "Nas", "Notorious B.I.G.", "2Pac", "Raekwon", "Prodigy", "Busta Rhymes", "Twista", "DMX", "Jay-Z", "2 Live Crew", "Big Pun", "Lauryn Hill", "Eminem", "Ghostface Killah", "Ludacris", "Jadakiss", "Korn", "D. Dre", "50 Cent", "Common", "Killer Mike", "T.I.",  "Lil Wayne", "Gucci Mane", "Rick Ross",  "Kanye West","Drake", "Nicki Minaj")) +
  theme(axis.text.x = element_text(angle = 90)) %>%
  labs(title = "Negative Sentiment Ratings", subtitle = "For Artists between 1979-2016", x = "Artist", y = "Negative Sentiment Rating") +
 
  theme_clean() +
  theme(axis.text.x = element_text(angle = 90)) 




```
^^^Sentiment over the years model 2??? Compiles words and sentiments 


```{r}
new <- merge(sentiments2, scores) %>%


  mutate(rah = case_when((ave_sentiment >= 0 & sumrow <= 0) ~ "positive", 
                        # (ave_sentiment == 0) ~ "neutral", 
                         (ave_sentiment <= 0 & sumrow >= 0) ~ "negative", 
                        TRUE ~ "neutral")) %>%
  
  mutate(har = case_when(rah == "positive" ~ 0, 
                   rah == "neutral" ~ 0, 
                   rah == "negative" ~ 1)) %>%
  
  group_by(artist) %>%
  summarise(sah = sum(har)) 


new %>%
ggplot(aes(x = factor(artist, level = c("grandmaster_caz", "grandmaster_melle_mel", "kurtis_blow", "kool_moe_dee", "spoonie_gee", "jimmy_spicer",  "run_dmc", "ll_cool_j", "roxanne_shante", "slick_rick", "beastie_boys",  "krsone", "too_short", "schoolly_d", "ice_cube", "chuck_d", "grand_puba", "kool_g_rap", "big_daddy_kane", "nwa", "method_man",  "scarface", "dres", "redman", "nas", "notorious_big", "2pac", "raekwon", "prodigy", "busta_rhymes", "twista", "dmx", "jayz", "big_pun", "lauryn_hill", "eminem", "ghostface_killah", "ludacris", "jadakiss", "dr_dre", "50_cent", "common", "ti",  "lil_wayne", "gucci_mane", "rick_ross",  "kanye_west","drake", "nicki_minaj")), y = sah)) +
  geom_col(fill = "darkblue", color = "skyblue") + 
  theme(axis.text.x = element_text(angle = 90)) +
  scale_x_discrete(labels = c("Grandmaster Caz", "Grandmaster Melle Mel", "Kurtis Blow", "Kool Moe Dee", "Spoonie Gee", "Jimmy Spicer",  "Run-DMC", "LL Cool J", "Roxanne Shante", "Slick Rick", "Beastie Boys", "Lil Boosie",  "KRS-One", "Too $hort", "Schoolly D", "Ice Cube", "Chuck D", "Grand Puba", "Kool G Rap", "Big Daddy Kane", "NWA", "Method Man",  "Scarface", "Dres", "Redman", "Nas", "Notorious B.I.G.", "2Pac", "Raekwon", "Prodigy", "Busta Rhymes", "Twista", "DMX", "Jay-Z", "2 Live Crew", "Big Pun", "Lauryn Hill", "Eminem", "Ghostface Killah", "Ludacris", "Jadakiss", "Korn", "D. Dre", "50 Cent", "Common", "Killer Mike", "T.I.",  "Lil Wayne", "Gucci Mane", "Rick Ross",  "Kanye West","Drake", "Nicki Minaj")) +
  labs(title = "Negative Sentiment Ratings", subtitle = "For Artists between 1979-2016", x = "Artist", y = "Negative Sentiment Rating") +
   theme_clean() +
  theme(axis.text.x = element_text(angle = 90)) 

  

```









```{r}
 
#Net Worth dataframe...where the fuck am I getting this information from?? Readin
# "grandmaster_caz", "kool_moe_dee", "spoonie_gee", "jimmy_spicer", "roxanne_shante", "beastie_boys", "krsone",   4
#"schoolly_d", "chuck_d", "big_daddy_kane", "kool_g_rap", "grand_puba", "scarface", "dr_dre", "dres",    5
#"method_man", "raekwon", "prodigy", "busta_rhymes", "twista", "big_pun", "lauryn_hill", "ghostface_killah",    6
#"ludacris", "jadakiss", "common", "gucci_mane", "rick_ross",   7
#"killer_mike", "korn", "2_live_crew", "lil_boosie"    8
```

Artists 4
```{r}

artists4 <- c("grandmaster_caz", "kool_moe_dee", "spoonie_gee", "jimmy_spicer", "schoolly_d", "roxanne_shante", "beastie_boys", "krsone")

artist_urls <- paste0("https://www.allthelyrics.com/lyrics/", artists4)

finaldata4 <- c() #setting up an empty dataset for the end


for (j in 1:length(artist_urls)) {
  
  all <- read_html(artist_urls[j])
  
  raps <- all %>%
    html_nodes(".lyrics-list-item") %>%
    # html_attr("href")
    html_text()
  
  raps # Here are the raps
  
  
  urls <- all %>%
    html_nodes("a") %>%
    html_attr("href")
  
  urls.d <- data.frame(webpage = urls, line = 1:length(urls))
  raps.d <- data.frame(titles = raps, artist = "Eminem")
  
  
  lyric_data4 <- urls.d %>%
    slice(-(1:38)) %>%
    head(-13) %>%
    mutate(Artist = artists4[j]) %>%
    mutate(titles = raps) %>%
    mutate(line = NULL) %>%
    mutate(webpage = paste0("https://www.allthelyrics.com", webpage))
  
  lyrics4 <- c()
  
  for(i in 1:length(lyric_data4$webpage)){ 
    
    words <- read_html(lyric_data4$webpage[i])
    lyrics4[i] <- words %>%
      html_nodes(".content-text-inner") %>%
      html_text()
    
  }
  
  lyric_data_words4 <- lyric_data4 %>%
    mutate(words = lyrics4)
  
  finaldata4 <- rbind(finaldata4, lyric_data_words4)
  
  
}

View(finaldata4)

write.csv(finaldata4, "finaldata4.csv")
```




Artists 5
```{r}
artists5 <- c("schoolly_d", "chuck_d", "big_daddy_kane", "kool_g_rap", "grand_puba", "scarface", "dr_dre", "dres") 

artist_urls <- paste0("https://www.allthelyrics.com/lyrics/", artists5)

finaldata5 <- c() #setting up an empty dataset for the end


for (j in 1:length(artist_urls)) {
  
  all <- read_html(artist_urls[j])
  
  raps <- all %>%
    html_nodes(".lyrics-list-item") %>%
    # html_attr("href")
    html_text()
  
  raps # Here are the raps
  
  
  urls <- all %>%
    html_nodes("a") %>%
    html_attr("href")
  
  urls.d <- data.frame(webpage = urls, line = 1:length(urls))
  raps.d <- data.frame(titles = raps, artist = "Eminem")
  
  
  lyric_data5 <- urls.d %>%
    slice(-(1:38)) %>%
    head(-13) %>%
    mutate(Artist = artists5[j]) %>%
    mutate(titles = raps) %>%
    mutate(line = NULL) %>%
    mutate(webpage = paste0("https://www.allthelyrics.com", webpage))
  
  lyrics5 <- c()
  
  for(i in 1:length(lyric_data5$webpage)){ 
    
    words <- read_html(lyric_data5$webpage[i])
    lyrics5[i] <- words %>%
      html_nodes(".content-text-inner") %>%
      html_text()
    
  }
  
  lyric_data_words5 <- lyric_data5 %>%
    mutate(words = lyrics5)
  
  finaldata5 <- rbind(finaldata5, lyric_data_words5)
  
  
}

View(finaldata5)

write.csv(finaldata5, "finaldata5.csv")
```

Artists 6 
```{r}
artists6 <- c("method_man", "raekwon", "prodigy", "busta_rhymes", "twista", "big_pun", "lauryn_hill", "ghostface_killah") 

artist_urls <- paste0("https://www.allthelyrics.com/lyrics/", artists6)

finaldata6 <- c() #setting up an empty dataset for the end


for (j in 1:length(artist_urls)) {
  
  all <- read_html(artist_urls[j])
  
  raps <- all %>%
    html_nodes(".lyrics-list-item") %>%
    # html_attr("href")
    html_text()
  
  raps # Here are the raps
  
  
  urls <- all %>%
    html_nodes("a") %>%
    html_attr("href")
  
  urls.d <- data.frame(webpage = urls, line = 1:length(urls))
  raps.d <- data.frame(titles = raps, artist = "Eminem")
  
  
  lyric_data6 <- urls.d %>%
    slice(-(1:38)) %>%
    head(-13) %>%
    mutate(Artist = artists6[j]) %>%
    mutate(titles = raps) %>%
    mutate(line = NULL) %>%
    mutate(webpage = paste0("https://www.allthelyrics.com", webpage))
  
  lyrics6 <- c()
  
  for(i in 1:length(lyric_data6$webpage)){ 
    
    words <- read_html(lyric_data6$webpage[i])
    lyrics6[i] <- words %>%
      html_nodes(".content-text-inner") %>%
      html_text()
    
  }
  
  lyric_data_words6 <- lyric_data6 %>%
    mutate(words = lyrics6)
  
  finaldata6 <- rbind(finaldata6, lyric_data_words6)
  
  
}

View(finaldata6)

write.csv(finaldata6, "finaldata6.csv")
```


Artists 7 
```{r}
artists7 <- c("ludacris", "jadakiss", "common", "gucci_mane", "rick_ross")

artist_urls <- paste0("https://www.allthelyrics.com/lyrics/", artists7)

finaldata7 <- c() #setting up an empty dataset for the end


for (j in 1:length(artist_urls)) {
  
  all <- read_html(artist_urls[j])
  
  raps <- all %>%
    html_nodes(".lyrics-list-item") %>%
    # html_attr("href")
    html_text()
  
  raps # Here are the raps
  
  
  urls <- all %>%
    html_nodes("a") %>%
    html_attr("href")
  
  urls.d <- data.frame(webpage = urls, line = 1:length(urls))
  raps.d <- data.frame(titles = raps, artist = "Eminem")
  
  
  lyric_data7 <- urls.d %>%
    slice(-(1:38)) %>%
    head(-13) %>%
    mutate(Artist = artists7[j]) %>%
    mutate(titles = raps) %>%
    mutate(line = NULL) %>%
    mutate(webpage = paste0("https://www.allthelyrics.com", webpage))
  
  lyrics7 <- c()
  
  for(i in 1:length(lyric_data7$webpage)){ 
    
    words <- read_html(lyric_data7$webpage[i])
    lyrics7[i] <- words %>%
      html_nodes(".content-text-inner") %>%
      html_text()
    
  }
  
  lyric_data_words7 <- lyric_data7 %>%
    mutate(words = lyrics7)
  
  finaldata7 <- rbind(finaldata7, lyric_data_words7)
  
  
}

View(finaldata7)

write.csv(finaldata7, "finaldata7.csv")
```


Artists 8 

```{r}
artists8 <- c("killer_mike", "korn", "2_live_crew", "lil_boosie")
             
artist_urls <- paste0("https://www.allthelyrics.com/lyrics/", artists8)

finaldata8 <- c() #setting up an empty dataset for the end


for (j in 1:length(artist_urls)) {
  
  all <- read_html(artist_urls[j])
  
  raps <- all %>%
    html_nodes(".lyrics-list-item") %>%
    # html_attr("href")
    html_text()
  
  raps # Here are the raps
  
  
  urls <- all %>%
    html_nodes("a") %>%
    html_attr("href")
  
  urls.d <- data.frame(webpage = urls, line = 1:length(urls))
  raps.d <- data.frame(titles = raps, artist = "Eminem")
  
  
  lyric_data8 <- urls.d %>%
    slice(-(1:38)) %>%
    head(-13) %>%
    mutate(Artist = artists8[j]) %>%
    mutate(titles = raps) %>%
    mutate(line = NULL) %>%
    mutate(webpage = paste0("https://www.allthelyrics.com", webpage))
  
  lyrics8 <- c()
  
  for(i in 1:length(lyric_data8$webpage)){ 
    
    words <- read_html(lyric_data8$webpage[i])
    lyrics8[i] <- words %>%
      html_nodes(".content-text-inner") %>%
      html_text()
    
  }
  
  lyric_data_words8 <- lyric_data8 %>%
    mutate(words = lyrics8)
  
  finaldata8 <- rbind(finaldata8, lyric_data_words8)
  
  
}

View(finaldata8)

write.csv(finaldata8, "finaldata8.csv")
```

Regression: using all artists 
```{r}
#Linking the fuccn spreadsheet and the data I have rn 
excel <- finaldata %>%
  select(!X4) %>%
  rename(net = "Net Worth") %>%
  drop_na()
  
  

whole <- merge(excel, sentiments) %>%
  select(!Artist)

profits <- stan_glm(data = whole, 
                    mean ~ Year + net, 
                    family = gaussian(), 
                    refresh = 0)
print(profits, digits = 5)
```

Trying to get sentiment terms out of there 

```{r}
profane <- complete_data %>%
   #select(titles, Artist, words) %>%
   group_by(artist, title) %>%
   get_sentences() %>%
   
 
profanity_by(profane$words, by = c("title", "artist"),  
 averaging.function = sentimentr::average_mean) %>%
   group_by(artist) %>%
  summarise(mean = mean(ave_profanity))

```



```{r}
pleasework <- complete_data %>%
   #select(titles, Artist, words) %>%
   group_by(artist, title) %>%
   get_sentences() %>%
   
 
extract_sentiment_terms(pleasework$words, 
                        polarity_dt = lexicon::hash_sentiment_jockers_rinker, 
                        hyphen = "")
```


```{r}

```



